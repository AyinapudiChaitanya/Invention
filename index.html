<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Robot Runner</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: flex-start;
      padding: 24px;
      gap: 24px;
    }
    canvas {
      border: 2px solid #f59e0b;
      border-radius: 12px;
      background: #1f2937;
    }
    .sidebar {
      max-width: 300px;
      background: #1f2937;
      border: 2px solid #374151;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 0 10px #00000033;
    }
    .sidebar h2 {
      font-size: 20px;
      margin-bottom: 12px;
      color: #f59e0b;
      text-align: center;
    }
    .score-entry {
      padding: 6px 0;
      border-bottom: 1px solid #374151;
      font-size: 16px;
    }
    .controls {
      margin-bottom: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    input {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #374151;
      background: #0b1220;
      color: #e5e7eb;
    }
    button {
      padding: 8px 12px;
      border-radius: 6px;
      border: none;
      background: #f59e0b;
      color: #0f172a;
      font-weight: 600;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="game" width="600" height="300"></canvas>

  <div class="sidebar">
    <div class="controls">
      <input id="playerName" type="text" placeholder="Enter your name" />
      <button onclick="startGame()">Start Game</button>
    </div>
    <h2>üèÜ Scoreboard</h2>
    <div id="scoreList"></div>
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const playerInput = document.getElementById('playerName');
    const scoreList = document.getElementById('scoreList');

    let playerName = '';
    let robot = { x: 50, y: 240, w: 30, h: 40, vy: 0, jumping: false };
    let obstacles = [];
    let gameRunning = false;
    let startTime = 0;
    let scores = JSON.parse(localStorage.getItem('robotScores') || '[]');

    function drawRobot() {
      ctx.fillStyle = '#60a5fa';
      ctx.fillRect(robot.x, robot.y, robot.w, robot.h);
    }

    function drawObstacle(ob) {
      ctx.fillStyle = '#f59e0b';
      ctx.fillRect(ob.x, ob.y, ob.w, ob.h);
    }

    function spawnObstacle() {
      const ob = {
        x: canvas.width,
        y: 260,
        w: 20,
        h: 40
      };
      obstacles.push(ob);
    }

    function updateGame() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Gravity
      if (robot.jumping) {
        robot.vy -= 1.5;
        robot.y -= robot.vy;
        if (robot.y >= 240) {
          robot.y = 240;
          robot.vy = 0;
          robot.jumping = false;
        }
      }

      // Move obstacles
      obstacles.forEach((ob, i) => {
        ob.x -= 4;
        drawObstacle(ob);

        // Collision
        if (
          ob.x < robot.x + robot.w &&
          ob.x + ob.w > robot.x &&
          ob.y < robot.y + robot.h &&
          ob.y + ob.h > robot.y
        ) {
          endGame();
        }

        // Remove off-screen
        if (ob.x + ob.w < 0) obstacles.splice(i, 1);
      });

      drawRobot();

      if (gameRunning) requestAnimationFrame(updateGame);
    }

    function startGame() {
      if (!playerInput.value.trim()) {
        alert('Please enter your name');
        return;
      }
      playerName = playerInput.value.trim();
      robot.y = 240;
      robot.vy = 0;
      robot.jumping = false;
      obstacles = [];
      gameRunning = true;
      startTime = Date.now();
      spawnObstacle();
      setInterval(() => {
        if (gameRunning) spawnObstacle();
      }, 1500);
      updateGame();
    }

    function endGame() {
      gameRunning = false;
      const runTime = ((Date.now() - startTime) / 1000).toFixed(2);
      scores.push({ name: playerName, time: parseFloat(runTime) });
      scores.sort((a, b) => b.time - a.time);
      scores = scores.slice(0, 5);
      localStorage.setItem('robotScores', JSON.stringify(scores));
      updateScoreboard();
      alert(`${playerName}, you lasted ${runTime} seconds!`);
    }

    function updateScoreboard() {
      scoreList.innerHTML = '';
      scores.forEach((entry, index) => {
        const div = document.createElement('div');
        div.className = 'score-entry';
        div.textContent = `${index + 1}. ${entry.name} ‚Äì ${entry.time.toFixed(2)}s`;
        scoreList.appendChild(div);
      });
    }

    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space' && !robot.jumping && gameRunning) {
        robot.jumping = true;
        robot.vy = 15;
      }
    });

    canvas.addEventListener('click', () => {
      if (!robot.jumping && gameRunning) {
        robot.jumping = true;
        robot.vy = 15;
      }
    });

    updateScoreboard();
  </script>
</body>
</html>
